# 19. Планы развития

KyroOS находится в активной стадии развития. Представленные ниже планы отражают наиболее актуальные направления для расширения функциональности, улучшения производительности и повышения стабильности системы. Эти планы основаны на текущих архитектурных компромиссах и выявленных ограничениях.

## 19.1. Расширение архитектуры ядра

### Многозадачность и синхронизация

-   **Реализация примитивов синхронизации:** Внедрение спинлоков, мьютексов и семафоров для обеспечения потокобезопасности и предотвращения состояния гонки в многопоточной среде.
-   **Полноценный механизм блокировки/пробуждения:** Разработка robust-механизма для перевода потоков в состояние ожидания и их последующего пробуждения по событиям (например, завершение I/O, доступность данных в буфере).
-   **Поддержка многоядерных процессоров (Symmetric Multiprocessing, SMP):** Адаптация ядра для работы на многоядерных системах, включая переработку механизмов синхронизации и планирования.

### Управление памятью

-   **Улучшение аллокации `fs_disk`:** Внедрение битмапа свободных блоков для `fs_disk` для эффективного переиспользования освобожденного дискового пространства и снижения фрагментации.
-   **Оптимизация `KyroFS`:** Реализация более эффективных стратегий выделения и перераспределения памяти для файлов в `KyroFS`, например, с использованием аллокации блоков или механизма копирования при записи (copy-on-write).

### Файловая система

-   **Интеграция `fs_disk` с VFS:** Адаптация `fs_disk` для использования через интерфейс VFS, что позволит монтировать ее в иерархию файловой системы.
-   **Иерархическая структура `fs_disk`:** Добавление поддержки директорий в `fs_disk` для создания полноценной файловой иерархии.
-   **Модель прав доступа:** Разработка и внедрение системы прав доступа (пользователь, группа, другие; чтение, запись, выполнение) для файлов и директорий на уровне VFS и конкретных реализаций ФС.
-   **Кэширование данных `fs_disk`:** Реализация буферного кэша для блоков данных `fs_disk` с стратегиями вытеснения (например, LRU) для повышения производительности дисковых операций.
-   **Поддержка других файловых систем:** Добавление драйверов для широко используемых файловых систем, таких как FAT32 или ext2/3/4.

### Сетевой стек

-   **Декомпозиция сетевого ядра:** Отделение общего сетевого ядра (`net_init`, `net_register_device`) от специфических драйверов (например, E1000) для повышения модульности и упрощения добавления новых сетевых драйверов.
-   **Завершение реализации TCP:** Доработка стека TCP для полной поддержки всех состояний, механизмов восстановления, управления окном и контрольных сумм.
-   **Добавление новых сетевых драйверов:** Внедрение драйверов для других популярных сетевых адаптеров (например, VirtIO Net, Realtek RTL8139).

### Графическая подсистема

-   **Разработка оконной системы пользовательского пространства:** Создание полноценной пользовательской библиотеки для отрисовки окон, виджетов и управления композицией на базе прямого доступа к framebuffer.
-   **Поддержка аппаратного ускорения GPU:** (Долгосрочная перспектива) Исследование и интеграция драйверов для графических процессоров с поддержкой аппаратного ускорения отрисовки.

## 19.2. Расширение возможностей пользовательского пространства

### Полнофункциональный менеджер пакетов KyroOS (KPM)
-   **Разработка KPM:** Доработка менеджера пакетов KPM до полнофункционального состояния, включающего:
    -   **Разрешение зависимостей:** Автоматическое определение и установка необходимых для пакета зависимостей.
    -   **Установка и удаление пакетов:** Надежные механизмы инсталляции, обновления и деинсталляции программного обеспечения.
    -   **Интеграция с репозиториями:** Возможность работы с удаленными или локальными репозиториями пакетов.
    -   **Формат пакетов:** Документирование и стандартизация формата `.kpkg` (KyroOS Package) с учетом метаданных, контрольных сумм и структуры.

-   **Полноценная `libc`:** Разработка или портирование более полной стандартной библиотеки C, предоставляющей не только обертки для системных вызовов, но и более широкий набор стандартных функций.
-   **Динамическая компоновка:** Внедрение поддержки динамических библиотек (shared libraries), что позволит уменьшить размер исполняемых файлов и упростит обновление компонентов.
-   **Улучшенная оболочка:** Развитие системной оболочки (`kyroshell`) с поддержкой истории команд, автодополнения, алиасов и скриптов.
-   **Дополнительные утилиты:** Разработка и интеграция более широкого набора стандартных Unix-подобных утилит (например, `grep`, `sed`, `awk`).

## 19.3. Улучшение системной стабильности и отладки

-   **Расширенная обработка ошибок:** Пересмотр текущей стратегии обработки ошибок в ядре с целью уменьшения количества Kernel Panic в случаях, когда возможно более мягкое восстановление (например, завершение проблемного процесса вместо паники всего ядра).
-   **Механизмы Crash Dump:** Реализация сохранения полного состояния ядра (дампа памяти) при Kernel Panic для последующего анализа офлайн-отладчиком.
-   **Инструменты профилирования и мониторинга:** Разработка инструментов для измерения производительности и выявления "узких мест" в ядре и приложениях.
-   **Тестирование:** Внедрение юнит-тестов и интеграционных тестов для ключевых компонентов ядра.
